#! /bin/bash/
sleep 1
echo -e "\033[0;33m "
echo "                 ****************************************************************************************************************************************************************" 
echo "                 *                                                                                                                                                              *"
echo "                 *      ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄       ▄▄▄▄▄▄▄▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄  ▄▄        ▄  ▄▄▄▄▄▄▄▄▄▄   ▄▄▄▄▄▄▄▄▄▄▄  ▄▄▄▄▄▄▄▄▄▄▄      *"
echo "                 *     ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌     ▐░░░░░░░░░░▌ ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░▌      ▐░▌▐░░░░░░░░░░▌ ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌     *"
echo "                 *     ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀█░▌     ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ ▐░▌░▌     ▐░▌▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀█░▌     *"
echo "                 *     ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌       ▐░▌     ▐░▌       ▐░▌▐░▌          ▐░▌          ▐░▌          ▐░▌▐░▌    ▐░▌▐░▌       ▐░▌▐░▌          ▐░▌       ▐░▌     *"
echo "                 *     ▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄█░▌     ▐░▌       ▐░▌▐░█▄▄▄▄▄▄▄▄▄ ▐░█▄▄▄▄▄▄▄▄▄ ▐░█▄▄▄▄▄▄▄▄▄ ▐░▌ ▐░▌   ▐░▌▐░▌       ▐░▌▐░█▄▄▄▄▄▄▄▄▄ ▐░█▄▄▄▄▄▄▄█░▌     *"
echo "                 *     ▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌     ▐░▌       ▐░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌▐░▌  ▐░▌  ▐░▌▐░▌       ▐░▌▐░░░░░░░░░░░▌▐░░░░░░░░░░░▌     *"
echo "                 *     ▐░█▀▀▀▀▀▀▀█░▌▐░█▀▀▀▀█░█▀▀ ▐░█▀▀▀▀▀▀▀▀▀      ▐░▌       ▐░▌▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀▀▀▀▀▀ ▐░▌   ▐░▌ ▐░▌▐░▌       ▐░▌▐░█▀▀▀▀▀▀▀▀▀ ▐░█▀▀▀▀█░█▀▀      *"
echo "                 *     ▐░▌       ▐░▌▐░▌     ▐░▌  ▐░▌               ▐░▌       ▐░▌▐░▌          ▐░▌          ▐░▌          ▐░▌    ▐░▌▐░▌▐░▌       ▐░▌▐░▌          ▐░▌     ▐░▌       *"
echo "                 *     ▐░▌       ▐░▌▐░▌      ▐░▌ ▐░▌               ▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄▄▄ ▐░▌          ▐░█▄▄▄▄▄▄▄▄▄ ▐░▌     ▐░▐░▌▐░█▄▄▄▄▄▄▄█░▌▐░█▄▄▄▄▄▄▄▄▄ ▐░▌      ▐░▌      *"
echo "                 *     ▐░▌       ▐░▌▐░▌       ▐░▌▐░▌               ▐░░░░░░░░░░▌ ▐░░░░░░░░░░░▌▐░▌          ▐░░░░░░░░░░░▌▐░▌      ▐░░▌▐░░░░░░░░░░▌ ▐░░░░░░░░░░░▌▐░▌       ▐░▌     *"
echo "                 *      ▀         ▀  ▀         ▀  ▀                 ▀▀▀▀▀▀▀▀▀▀   ▀▀▀▀▀▀▀▀▀▀▀  ▀            ▀▀▀▀▀▀▀▀▀▀▀  ▀        ▀▀  ▀▀▀▀▀▀▀▀▀▀   ▀▀▀▀▀▀▀▀▀▀▀  ▀         ▀      *"
echo "                 *    _______________________________________________________________________________________________________________________________________________________   *"
echo -e "\033[0;91m                 *                                            AN APPLICATION FOR GUARDING AGAINST ARP POISONING ATTACK                                                          *"
echo -e  "\033[0;33m                 *                                                                                                                                                              *"
echo "                 ****************************************************************************************************************************************************************"
echo -e "\033[0;35m "
sleep 1
echo "@---------- Welcome to ARP Defender ----------@ "
echo " "
sleep 1
echo "--> To Start Service select options :- "
echo " 1.Start Service "
echo " 2.Exit " 
read -p "--> Enter your option :- " num
echo " "
if [ "$num" == 1 ]; then
    sleep 2
    echo "-> Starting ARP Defender......."
	if [ $USER = "root" ] ;then
		systemctl daemon-reload
		systemctl enable arp.service
		systemctl start arp.service
	else
		echo "This script needs root Permission .. run it as sudo user please .."
	fi
	sleep 2
	echo "-> Successfully Started :) :)"
	sleep 2
	echo "-> Scanning the network for attacks......"
	while :; do
		if [ -d /opt/APP_arp/arp_warnings ] | [ -d /opt/APP_arp/Logging ];
		then
			sleep 1
			echo ""
			echo -e "\e[31m--> Warning!! You have been Attacked" 
			echo -e "\033[0;36m "
			echo "--> Select an Option You want to see "
			echo " 1. Warnings "
			echo " 2. Logging "
			echo " 3. Exit "
			read -p "--> Your Option :-  " Option
			sleep 1 
			case $Option in 
			1)  cd /opt/APP_arp/arp_warnings
			    echo ""
			    echo "Files inside the Warnings Directory :- "
			    echo ""
			    ls
			    echo ""
			    sleep 1
			    read -p "-> Enter file name :  " num1
			    sleep 2
			    echo ""
			    cat $num1 
			    echo ""
			    sleep 4 ;;
			  
			 
			2)  cd /opt/APP_arp/Logging
			    echo "" 
			    echo "Files inside the Logging Directory :- "
			    echo ""
			    ls
			    echo ""
			    sleep 1
			    read -p "--> Enter file name :  " num2
			    sleep 2
			    echo ""
			    cat $num2
			    echo ""
			    sleep 4 ;;
			    
			3) exit 
			   sleep 2 ;;
			 
			*) echo " Invalid Input Entered !!" ;;
			esac
			   
		fi
	done
elif [ "$num" == 2 ]; then
	sleep 1
	exit
else
	echo "Error! Enter a valid input"
fi
exit 0
